混合云的话题非常大，可以从底层数据中心的建设一直往上聊到上层的应用是如何编排。不过，时间有限，这次的分享很难覆盖所有的点，我就从我熟悉的几个方面展开，希望通过这次抛砖和大家一起交流交流

这次分享的主题主要包含下面4点：  
1.为什么客户需要混合云  
2.混合云的几种方式  
3.OpenStack与异构平台（阿里云）混合云介绍  
4.Openstack同构云平台混合云介绍

第一，为什么需要混合云  
首先，我们先来看看最近云计算市场的发展趋势。

![](https://mmbiz.qpic.cn/mmbiz/u6UOjABnicbtt2TCRvfbTZfloL4R8pRLGnGH4dFcLGUbbRkHwVTkvTl3cbZFFYib81djIicT16YyzLicn9wjX5b8xA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)  


rightscale 2016这份报告是其中一份比较好了解当前云计算市场发展趋势的报告，由rightscale在今年1月份通过采样调查1060名IT从业人员完成。

从报告的title可以看见：Hybrid cloud adoption ramps as cloud users and cloud providers mature

![](https://mmbiz.qpic.cn/mmbiz/u6UOjABnicbtt2TCRvfbTZfloL4R8pRLGGicmgibpzMpyRHKQicLoYeiad78uiaibiacLwQZQxGHy4WIdto0lAOYyUDHWg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)  


根据这份报告，混合云落地快速增长的主要原因有3点：  
1.随着私有云的落地从63%增长至77%，进一步促进混合云的落地比例从58%增长至71%  
2.82%的受访企业表示他们有混合云战略，这一比例与去年基本持平。  
3.95%的受访用户表示他们已经或尝试在IaaS上运行自己的应用

看完这份报告，不禁会有几个问题：  
1.为什么客户需要上混合云，混合云战略能够帮助他们解决什么问题？  
2.选择混合云方案的时候需要重点考虑哪些因素？

只有深入研究客户的需求和动机，我们才能给客户满意的混合云解决方案。下面我依次回答一下上面2个问题

首先，显而易见，客户希望通过采用混合云来同时享受私有云和公有云的优点，最简单的理解就是我可以非常灵活地把认为重要、敏感的数据放在私有云中，同时又能够在需要的时候快速获得公有云提供的丰富资源，达到安全、省钱和灵活的目的。

我们来进一步看看混合云有哪些典型的用户场景：

**1.Cloud bursting。**混合云突破私有云的硬件限制，充分利用公有云的弹性和可扩展性。当应用遇到需求高峰时，私有云中的应用不需要等待IT人员去采购额外的硬件资源来应付，可以通过调用公有云的资源来满足这种短暂的需求高峰，达到节省成本的目的。在电商、手游等互联网行业此类场景比较普遍。

**2.灾难恢复与业务连续性。**公有云由于规模效应，往往能够提供更为经济的存储、计算等资源，企业可以更频繁地将备份存放至公有云中，用作灾备和保证业务连续性。

**3.异构环境管理。**用户可以通过混合云战略，实现多云共存，将应用同时部署在多个云上，充分利用不同云供应商的优点，同时还能够降低风险。

**4.云间应用迁移。**用户一般可以在私有云中进行本地的开发测试，然后利用公有云强大的互联网属性，将应用迁移至公有云中更好地服务更广大的客户。

**5.应用高可用。**在设计应用高可用的时候，往往涉及不同层级的高可用，如主机、机房、网络等。通过混合云战略，可用提供云平台层次的高可用。

通过了解这些应用场景，发现混合云方案设计需要考虑的因素可用主要分为3个方面：

* 第一，就是吃透客户的需求和主要用户场景。没有银弹，不可能有一套方案能够满足所有的需求，我们要能够深入客户的需求，才能最大的满足客户。

* 第二，技术因素。下面会详细介绍。

* 第三，运营因素

![](https://mmbiz.qpic.cn/mmbiz/u6UOjABnicbtt2TCRvfbTZfloL4R8pRLGLUh1t8SJTIQhbjEVFItap5YdVbKjYpS9edGT4F6bMPtibyTMEP7nTpA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)  


涉及的点比较多，我就挑其中的一些来谈一下  
**工具：**

* 要关注混合云是否提供足够多的工具集来保证混合云的正常运行和管理维护，如统一监控、预警等。

* 混合云平台中应该要能够提供客户在不同云中的使用情况和消费记录。

* 还要能够为客户提供跨平台的应用编排，满足客户在高可用、灾备方面等需求

**网络：**

* 从不同云平台使用的角度出发，混合云平台要能够统一管理不同云平台中的网络资源，让用户能够通过混合云平台透明地使用各种资源，不同不会有误解和错用。

* 从云平台基础设施出发，混合云平台还要能够保证不同云直接的高速、稳定、可靠的互联，如专线VPN等手段

**管理：**

* 混合云架构容易引入来自不同云平台的很多概念，一不小心就把用户给弄晕了，不知如何操作，增强管理复杂度。

* 好的混合云平台应该能够简化用户管理，很好的抽象和统一，提高管理效率。

**风险：**

* 不同云平台在可用性、服务水平、安全级别和API之间都存在差异，这些差异容易在混合云平台上面进一步放大，混合云平台应该为用户屏蔽因为差异造成的风险，或者提供必要的告知义务。

* 还需要能够及时管理来自不同云平台的变化，如API变化、SLA变化等

**容量规划：**

* 大部分公司选择混合云的原因是希望通过公有云的弹性来提高应用的服务能力，同时又能够减少自身的固定资产投资。因此，在一整套混合云方案中，我们需要着重考虑对私有云和公有云的容量规划，针对用户历史使用量分析，能够对未来一段时间进行预测，提出一套最节省成本的混合方案。

* 一般情况下可以通过vCPU, RAM, bandwidth这些资源指标来规划具体容量。

* 有一个误解是，尽可能将所有的workload放在私有云上面，只有不得已才会使用公有云上面的资源。其实，现实情况远比这个复杂，混合云的目的是充分利用各个云平台的长处，因此，更好的方式应该是需要结合业务的特点和云平台的特点进行通盘考虑，通过平台中的数据分析工具来自动进行应用编排。

**性能：**

* 不同云平台表现的性能是不同的，它们擅长的workload类型也会有差异，混合云平台如何能够在应用编排的时候，根据应用的特点和平台特点进行编排调度达到最好的性能。

**运营：**

* 私有云中使用的镜像格式要在对应的公有云中兼容，避免转换的麻烦

* 为了简化应用的不是，平时多使用Chef、Puppet等部署工具

* 用户的应用是否已经云化，在此准备迁入云中前要做什么准备和改造，如分布式、微服务？是否有高可用和自动扩容等

* 考虑混合云平台如何应对升级、维护

![](https://mmbiz.qpic.cn/mmbiz/u6UOjABnicbtt2TCRvfbTZfloL4R8pRLGzvBjb8Gb0kFS4EtCCicQBF280gUUBQFpQIt2LrlRxFsQgqFvK9q0o8Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)  
第二，混合云管理的几种方式。

![](https://mmbiz.qpic.cn/mmbiz/u6UOjABnicbtt2TCRvfbTZfloL4R8pRLGosxNAZfhrhMQ52BltbadJGgciajwThtbRNwvic1Xvibs7M4Kg1zacpmyg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)  


**从云平台属性出发**

* 异构云平台管理：OpenStack云平台与第三方云平台，如阿里云，的混合云管理

* 同构云平台管理：多个OpenStack云平台之间的混合云管理.

**从管理方式出发**

* 集中管理：在不同云之上存在一个集中管理平台，用户一般只通过这个平台来使用不同云中的资源，如fit2cloud

* 联合管理：不同云之间是相互联合、相互信任的，同一个用户可以通过single-sign-on的方式，非常方便的使用不同云平台中的资源，如OpenStack Cloud federation, CERN是比较有代表的。

一般情况下，异构云平台管理的混合云方案倾向使用集中管理的方式

**优点：**

* 用户不需要关心每个平台的具体细节，只需要与混合云管理平台交互，可以降低学习成本。

* 混合云平台可以进一步的封装、抽象，甚至加入一些额外的业务逻辑，如CICD等，来提高用户体验。

* 用户可以比较灵活的选择使用不同的云平台满足不同的业务需求。

**缺点：**

* 混合云管理平台涉及的逻辑比较多和复杂，比较重量级。

* 存在一定的安全隐患，因为各个云平台的用户名密码需要由混合云平台来管理使用。

* 由于混合云管理平台的进一步封装、抽象，可能会导致用户无法使用某些云平台的特性。

对于同构云平台管理的混合云方案倾向使用联合管理的方式

**优点：**

* 通过联合认证的方式可以提高安全性、降低风险

* 简化业务流程，用户只需要一组用户名密码就可以访问所有的OpenStack公有云和私有云，对于本身就熟悉OpenStack的人来说，基本没有学习成本，混合云管理平台可以更加轻量级。

**缺点：**

* 差异化功能比较少

* 目前只存在于OpenStack云平台之间



